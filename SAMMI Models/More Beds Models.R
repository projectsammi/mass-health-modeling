#Markov chain package
library("markovchain")

#Worcester baseline
stages<-c("General Population","Directed Use","Directed OD","Recreational Use","Recreational OD","Misuse","OD From Misuse","Active Use Addiction","OD From Addiction","Detoxification","Addiction Treatment","Recovery Management","Death")

#stage vectors
genpop<-c(1,0,0,0,0,0,0,0,0,0,0,0,0)
du<-c(0,1,0,0,0,0,0,0,0,0,0,0,0)
DirectedOD<-c(0,0,1,0,0,0,0,0,0,0,0,0,0)
recreational<-c(0,0,0,1,0,0,0,0,0,0,0,0,0)
recreationalOD<-c(0,0,0,0,1,0,0,0,0,0,0,0,0)
misuse<-c(0,0,0,0,0,1,0,0,0,0,0,0,0)
misuseOD<-c(0,0,0,0,0,0,1,0,0,0,0,0,0)
addiction<-c(0,0,0,0,0,0,0,1,0,0,0,0,0)
addictionOD<-c(0,0,0,0,0,0,0,0,1,0,0,0,0)
detox<-c(0,0,0,0,0,0,0,0,0,1,0,0,0)
treatment<-c(0,0,0,0,0,0,0,0,0,0,1,0,0)
recovery<-c(0,0,0,0,0,0,0,0,0,0,0,1,0)
death<-c(0,0,0,0,0,0,0,0,0,0,0,0,1)

#Insert matrix. Make sure each row adds up to 1, if pasting values.
worcesterbeds<-matrix(data=c(0.99961,	0.00037,0.00000,0.00000,0.00000,0.00002,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                             0.03810,	0.95238,0.00004,0.00000,0.00000,0.00948,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                             0.00000,	0.98747,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.01253,
                             0.00000,	0.00000,0.00000,1.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                             0.00000,	0.00000,0.00000,0.00000,1.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                             0.01700,	0.01000,0.00000,0.00000,0.00000,0.95225,0.00075,0.02000,0.00000,0.00000,0.00000,0.00000,0.00000,
                             0.00000,	0.00000,0.00000,0.00000,0.00000,0.98747,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.01253,
                             0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.99250,0.00150,0.00600,0.00000,0.00000,0.00000,
                             0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.98747,0.00000,0.00000,0.01253,
                             0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.09625,0.00000,0.75000,0.05750,0.09625,0.00000,
                             0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.02000,0.00000,0.00000,0.94865,0.03135,0.00000,
                             0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.01000,0.00000,0.00000,0.00000,0.99000,0.00000,
                             0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,1.00000),byrow=TRUE,nrow=13)
worcesterday<-new("markovchain",states=stages,byrow=TRUE,transitionMatrix=worcesterbeds)

#Shrewsbury
shrewsburybeds<-matrix(data=c(0.99976,0.00022,0.00000,0.00000,0.00000,0.00002,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                              0.03333,0.95833,0.00005,0.00000,0.00000,0.00829,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                              0.00000,0.98276,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.01724,
                              0.00000,0.00000,0.00000,1.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                              0.00000,0.00000,0.00000,0.00000,1.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                              0.01700,	0.01000,0.00000,0.00000,0.00000,0.95284,0.00016,0.02000,0.00000,0.00000,0.00000,0.00000,0.00000,
                              0.00000,0.00000,0.00000,0.00000,0.00000,0.98276,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.01724,
                              0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.99368,0.00032,0.00600,0.00000,0.00000,0.00000,
                              0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.98276,0.00000,0.00000,0.01724,
                              0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.09625,0.00000,0.75000,0.05750,0.09625,0.00000,
                              0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.02000,0.00000,0.00000,0.94865,0.03135,0.00000,
                              0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.01000,0.00000,0.00000,0.00000,0.99000,0.00000,
                              0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,1.00000),byrow=TRUE,nrow=13)
shrewsburyday<-new("markovchain",states=stages,byrow=TRUE,transitionMatrix=shrewsburybeds)

#Holden
holdenbeds<-matrix(data=c(0.99974,0.00024,0.00000,0.00000,0.00000,0.00002,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                          0.04000,0.95000,0.00005,0.00000,0.00000,0.00995,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                          0.00000,0.96154,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.03846,
                          0.00000,0.00000,0.00000,1.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                          0.00000,0.00000,0.00000,0.00000,1.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                          0.01700,	0.01000,0.00000,0.00000,0.00000,0.95285,0.00015,0.02000,0.00000,0.00000,0.00000,0.00000,0.00000,
                          0.00000,0.00000,0.00000,0.00000,0.00000,0.96154,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.03846,
                          0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.99370,0.00030,0.00600,0.00000,0.00000,0.00000,
                          0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.96154,0.00000,0.00000,0.03846,
                          0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.09625,0.00000,0.75000,0.05750,0.09625,0.00000,
                          0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.02000,0.00000,0.00000,0.94865,0.03135,0.00000,
                          0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.01000,0.00000,0.00000,0.00000,0.99000,0.00000,
                          0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,1.00000),byrow=TRUE,nrow=13)
holdenday<-new("markovchain",states=stages,byrow=TRUE,transitionMatrix=holdenbeds)

#Millbury
millburybeds<-matrix(data=c(0.99972,0.00026,0.00000,0.00000,0.00000,0.00002,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                            0.03478,0.95652,0.00005,0.00000,0.00000,0.00865,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                            0.00000,0.96078,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.03922,
                            0.00000,0.00000,0.00000,1.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                            0.00000,0.00000,0.00000,0.00000,1.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                            0.01700,	0.01000,0.00000,0.00000,0.00000,0.95260,0.00040,0.02000,0.00000,0.00000,0.00000,0.00000,0.00000,
                            0.00000,0.00000,0.00000,0.00000,0.00000,0.96078,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.03922,
                            0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.99320,0.00080,0.00600,0.00000,0.00000,0.00000,
                            0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.96078,0.00000,0.00000,0.03922,
                            0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.09625,0.00000,0.75000,0.05750,0.09625,0.00000,
                            0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.02000,0.00000,0.00000,0.94865,0.03135,0.00000,
                            0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.01000,0.00000,0.00000,0.00000,0.99000,0.00000,
                            0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,1.00000),byrow=TRUE,nrow=13)
millburyday<-new("markovchain",states=stages,byrow=TRUE,transitionMatrix=millburybeds)

#West Boylston
westboylstonbeds<-matrix(data=c(0.99982,0.00016,0.00000,0.00000,0.00000,0.00002,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                                0.06667,0.91667,0.00008,0.00000,0.00000,0.01658,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                                0.00000,0.99000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.01000,
                                0.00000,0.00000,0.00000,1.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                                0.00000,0.00000,0.00000,0.00000,1.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                                0.01700,	0.01000,0.00000,0.00000,0.00000,0.95256,0.00044,0.02000,0.00000,0.00000,0.00000,0.00000,0.00000,
                                0.00000,0.00000,0.00000,0.00000,0.00000,0.99000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.01000,
                                0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.99312,0.00088,0.00600,0.00000,0.00000,0.00000,
                                0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.99000,0.00000,0.00000,0.01000,
                                0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.09625,0.00000,0.75000,0.05750,0.09625,0.00000,
                                0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.02000,0.00000,0.00000,0.94865,0.03135,0.00000,
                                0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.01000,0.00000,0.00000,0.00000,0.99000,0.00000,
                                0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,1.00000),byrow=TRUE,nrow=13)
westboylstonday<-new("markovchain",states=stages,byrow=TRUE,transitionMatrix=westboylstonbeds)

#Leicester
leicesterbeds<-matrix(data=c(0.99983,	0.00015,0.00000,0.00000,0.00000,0.00002,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                             0.04211,	0.94737,0.00005,0.00000,0.00000,0.01047,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                             0.00000,	0.96429,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.03571,
                             0.00000,	0.00000,0.00000,1.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                             0.00000,	0.00000,0.00000,0.00000,1.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,
                             0.01700,	0.01000,0.00000,0.00000,0.00000,0.95274,0.00026,0.02000,0.00000,0.00000,0.00000,0.00000,0.00000,
                             0.00000,	0.00000,0.00000,0.00000,0.00000,0.96429,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.03571,
                             0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.99348,0.00052,0.00600,0.00000,0.00000,0.00000,
                             0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.96429,0.00000,0.00000,0.03571,
                             0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.09625,0.00000,0.75000,0.05750,0.09625,0.00000,
                             0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.02000,0.00000,0.00000,0.94865,0.03135,0.00000,
                             0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.01000,0.00000,0.00000,0.00000,0.99000,0.00000,
                             0.00000,	0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,1.00000),byrow=TRUE,nrow=13)
leicesterday<-new("markovchain",states=stages,byrow=TRUE,transitionMatrix=leicesterbeds)

#1 year general population for all cities
genpop*worcesterday^365
genpop*shrewsburyday^365
genpop*holdenday^365
genpop*millburyday^365
genpop*westboylstonday^365
genpop*leicesterday^365
